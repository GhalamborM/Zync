CREATE FUNCTION ZzEndOfDay (@date DATETIME)
RETURNS DATETIME
AS
BEGIN
    RETURN DATEADD(ms, -3, DATEADD(dd, 1, CAST(CAST(@date AS DATE) AS DATETIME)))
END
GO
